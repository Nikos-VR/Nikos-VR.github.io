<html>

<head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/@croquet/croquet"></script>
    <script
        src="https://cdn.jsdelivr.net/gh/NikolaySuslov/aframe-croquet-component/public/lib/aframe-croquet-component.js">
    </script>
    <script>
        AFRAME.registerComponent('flying', {
            tick: function () {
                if (Math.random() < 0.95) return;
                var el = this.el;
                var x = Math.random() * 1000 - 500;
                var z = Math.random() * 1000 - 500;
                var d = Math.random() * 10000 + 5000;
                el.setAttribute('animation', 'property: position; to: ' + x + ' 2 ' + z + '; easing: easeInOutQuad; dur: ' + d);
            }
        });
        AFRAME.registerComponent('key', {
            init: function () {
                var el = this.el;
                el.addEventListener('click', function () {
                    var sound = new Audio();
                    sound.src = "Cow_Moo-Mike_Koenig-42670858.mp3";
                    sound.play();
                    el.remove();
                });
            }
        });
    </script>
</head>

<body>
    <a-scene id="s1" background="color:cadetblue" cursor="rayOrigin: mouse">
        <a-assets>
            <a-asset-item id="t1" src="tree.gltf"></a-asset-item>
            <a-asset-item id="b1" src="bird.gltf"></a-asset-item>
            <a-asset-item id="g1" src="ghost.gltf"></a-asset-item>
            <a-asset-item id="c1" src="cow.gltf"></a-asset-item>
        </a-assets>
        <a-plane height="1000" width="1000" rotation="-90 0 0" color="forestgreen"></a-plane>
        <a-text value="CLICK HERE TO START" geometry="primitive:plane" key></a-text>
        <a-light id="l1" type="ambient" intensity="1"></a-light>
        <a-camera id="c1" position="0 1.5 0">
            <a-light id="l2" type="spot" distance="100" angle="15" decay="2"></a-light>            
        </a-camera>
    </a-scene>
    <template id="avatarTemplate">
        <a-entity gltf-model="#t1" scale="0.1 0.1 0.1"></a-entity>
    </template>
    <script>
        var scene1 = document.getElementById('s1');
        for (var i = 0; i < 1000; i++) {
            var tree = document.createElement('a-entity');
            var x = Math.random() * 1000 - 500;
            var z = Math.random() * 1000 - 500;
            var s = Math.random() / 100 + 0.01;
            var r = Math.random() * 180 - 90;
            tree.setAttribute('gltf-model', '#t1');
            tree.setAttribute('position', x + ' 0 ' + z);
            tree.setAttribute('scale', s + ' ' + s + ' ' + s);
            tree.setAttribute('rotation', '0 ' + r + ' 0');
            scene1.appendChild(tree);
            if (i % 100 == 0) {
                var ghost = document.createElement('a-entity');
                ghost.setAttribute('gltf-model', '#g1');
                ghost.setAttribute('flying', '');
                ghost.setAttribute('scale', '3 3 3');
                scene1.appendChild(ghost);
            }
        }
        var cow = document.createElement('a-entity');
        x = Math.random() * 1000 - 500;
        z = Math.random() * 1000 - 500;
        cow.setAttribute('gltf-model', '#c1');
        cow.setAttribute('position', x + ' 0 ' + z);
        cow.setAttribute('sound', 'src: url(Cow_Moo-Mike_Koenig-42670858.mp3); autoplay: true; loop: true');
        scene1.appendChild(cow);
        var bird1 = document.createElement('a-entity');
        bird1.setAttribute('gltf-model', '#b1');
        bird1.setAttribute('scale', '3 3 3');
        bird1.setAttribute('animation', 'property: position; from: -10 50 -500; to: -10 50 500; dur: 25000; loop: true');
        bird1.setAttribute('sound', 'src: url(Hawk Call 2x-SoundBible.com-1697796838.mp3); autoplay: true; loop: true');
        scene1.appendChild(bird1);
        var bird2 = document.createElement('a-entity');
        bird2.setAttribute('gltf-model', '#b1');
        bird2.setAttribute('scale', '3 3 3');
        bird2.setAttribute('rotation', '0 180 0');
        bird2.setAttribute('animation', 'property: position; from: 10 50 500; to: 10 50 -500; dur: 33000; loop: true');
        bird2.setAttribute('sound', 'src: url(Hawk Call 2x-SoundBible.com-1697796838.mp3); autoplay: true; loop: true');
        scene1.appendChild(bird2);
    </script>
</body>

</html>
